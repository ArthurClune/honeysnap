INSTALLING HONEYSNAP
=====================

This document explains step by step how to install Honeysnap, including
all dependencies. Suggestions for this document, or Honeysnap in general
should be sent to <honeysnap@honeynet.org> or the public mail list at
https://public.honeynet.org/mailman/listinfo/honeysnap.

This document is broken down into the following parts:

1: Dependencies
2: Installation on a Linux/Unix/OS X Workstation
3: Installation on Windows
4: Running Honeysnap
5: OPTIONAL. Installing matplotlib 
6: OPTIONAL. Install the web front end                      


1. DEPENDENCIES
================

General Dependencies
 Python 2.4 or greater      http://www.python.org
 libpcap                    http://sourceforge.net/projects/libpcap/
 pypcap 1.1 or greater      http://code.google.com/p/pypcap/
                            (or from http://www.honeynet.org/tools/honeysnap/pypcap-1.1.tar.gz for Linux, see below)
 Either sqlite or PostgresSQL

Pure python modules:
 irclib 0.4.6 or greater    http://python-irclib.sourceforge.net/
 dpkt                       http://code.google.com/p/dpkt/
 magic                      http://www.demonseed.net/~jp/code/magic.py  
 sqlalchemy					http://www.sqlalchemy.org

This latter set should be installed automatically and are listed
here for completeness.  

For database use you will need either sqlite (for small datasets)
or PostgreSQL plus the appropriate Python module.

sqlite - pysqlite
postgresql - psycopg2

sqlite is also needed for testing.

Honeysnap should work with any database SQLAlchemy supports (including
Oracle), but this has not been tested. Currently there are various 
problems with mysql and this is not recommended. See doc/mysql.txt
for details.
                    
For geolocation (optional) we currently support ip2location with the 
UK Honeynet Project's ip2location python module.

      
2: INSTALLATION ON UNIX
========================

First, you will need to install python and its header file. Most
distributions most likely already have this installed. Then you will
need libpcap. For most UNIX-like systems, it should be in your package
management system (apt-get, yum, DarwinPorts etc.). You will need libcap
and also libpcap-devel if that is listed separately.

For example, on Debian / Ubuntu:

  $ sudo apt-get install python24-dev
  $ sudo apt-get install libpcap libpcap-dev

Or on Fedora 7:

  $ su -
  $ yum install python python-devel
  $ yum install libpcap libpcap-devel

Database:

For sqlite (for the test):

$ sudo apt-get install sqlite3 libsqlite3 libsqlite3-dev python-sqlite3

sqlite is required to run the tests.

For PostgreSQL:

$ sudo apt-get install postgresql81 postgresql-server-dev-8.1
$ sudo easy_install py-psycopg2

Note that the py-psycopg2 in Ubuntu not suitable as it is compiled 
against postgres7.                              

Get pypcap from http://www.honeynet.org/tools/honeysnap/pypcap-1.1.tar.gz

This version is the same as the one from Dug Song's site, but with the 
installer altered to install cleanly on linux and on python 2.5.
                              
$ wget http://www.honeynet.org/tools/honeysnap/pypcap-1.1.tar.gz
$ tar xvzf pypcap-1.1.tar.gz
$ cd pcap-1.1
$ sudo python setup.py install

You should then be able to install Honeysnap and all its remaining
dependencies (provided you have a network connection).

eg. for version 1.0.4:

  $ tar xvzf honeysnap-1.0.4
  $ cd honeysnap-1.0.4
  $ sudo python setup.py install

If you already have easy_install installed, you can simplify the
installation process further by simply executing the following.
   
  $ sudo easy_install http://www.honeynet.org/tools/honeysnap/pypcap-1.1.tar.gz
  $ sudo easy_install honeysnap-1.0.4.tar.gz 

This is exactly the same as unpacking the distribution from the tar file
and running 'sudo python setup.py install' and replaces the install 
of pypcap and honeysnap from tarballs.

Please note that this will install the honeysnap script into your
PATH, usually in /usr/bin. If this isn't what you want, specify
--script-dir. e.g

$ sudo easy_install --script-dir /usr/local/bin honeysnap-1.0.3.tar.gz


Some notes on python 2.5 and OS/X     
---------------------------------

If upgrading Python on a Mac, and you hit problems, try getting the
Python pkg from www.python.org, not from Darwin ports and get pypcap from
Dug Song's site as a Mac pkg:

http://code.google.com/p/pypcap/downloads/list


3: INSTALLATION ON WINDOWS
==========================

Download  and install the following, in order.

  * Python 2.4 (from http://www.python.org/download). You can install
  from the Windows MSI installer linked from that page.

  * winpcap from
  http://www.winpcap.org/install/default.htm  
	
  * pypcap from http://www.monkey.org/~dugsong/pypcap
  You need to download and run the 'Windows Python 2.4 Installer'

To make Python easily available on the command line, right click
on "My Computer" and select Properties. Then go to Advanced and
choose Environment Variables. Add to the end of the PATH variable 

 ;C:\Python24;C:\Python24\Scripts

(assuming you installed Python to the default location). If you 
don't already have setuptools installed, you'll need to download 
ez_setup.py from

  http://peak.telecommunity.com/dist/ez_setup.py

and run it. This will install easy_setup. Finally run

  easy_install honeysnap-1.0.4.zip
                                                    
This should download and install honeysnap and all its
dependencies.

                 

5: Running honeysnap
====================
Try to execute 'honeysnap':

  $ honeysnap

You should see:
                               
usage: honeysnap [options]

options:
  --version             show program's version number and exit
  -h, --help            show this help message and exit
  [.... more options snipped....]

  Please see the accompanying documentation (doc/USAGE) for instructions
  on configuration.


5: OPTIONAL. Installing Matplotlib
=================================

This doens't autoinstall yet as it's not essential, and is
best installed via your systems package management. It's
easiest on Ubuntu: Install

ipython
python-numpy python-numpy-dev python-scipy
python-matplotlib python-matplotlib-data python-matplotlib-doc
                   
for matplotlib. To install basemap (for the world maps) get 
basemap-0.9.5.tgz and follow the install instructions in the README
http://sourceforge.net/project/showfiles.php?group_id=80706

For testing, try

$ ipython -pylab
> plot([1,2,3])

If that produces a graph, it's good.
      

6: OPTIONAL. Installing the web front end
=========================================

Install TurboGears from http://www.turbogears.org/download, or just

wget http://www.turbogears.org/download/tgsetup.py
sudo python tgsetup.py

cd honeysnap-web, edit the sqlalchemy.dburi option in dev.cfg to point
at your database. Run 

$ tg-admin sql create
$ ./start-honeysnap_web.py

Then go to http://localhost:8080

to explore.